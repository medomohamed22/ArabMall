<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Donate Way - Pi Network</title>
<script src="https://sdk.minepi.com/pi-sdk.js"></script>

<style>
body{
    font-family:'Segoe UI',Tahoma;
    background:linear-gradient(135deg,#f5f0ff,#e6d9ff);
    margin:0;min-height:100vh;color:#4a148c
}
.container{max-width:1200px;margin:auto;padding:20px}
.header{text-align:center;margin-bottom:50px;position:relative}
.logo{font-size:90px;color:#7e57c2}
#lang-switch{
    position:absolute;top:10px;right:10px;
    background:#7e57c2;color:#fff;border:none;
    padding:10px 20px;border-radius:50px;cursor:pointer
}
h1{color:#6a1b9a}
p.intro{font-size:18px}
#user{font-size:22px;font-weight:bold;margin:15px}

.campaigns{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
    gap:30px
}
.campaign-card{
    background:#fff;padding:25px;border-radius:25px;
    box-shadow:0 10px 30px rgba(126,87,194,.2);
    text-align:center
}
.icon{font-size:55px}
.amount-btn{
    background:#ede7f6;border:2px solid #b39ddb;
    padding:8px 15px;border-radius:50px;
    cursor:pointer;margin:5px
}
.amount-btn.selected{
    background:#7e57c2;color:#fff
}
.custom-input{
    padding:10px;border-radius:50px;
    border:2px solid #b39ddb;width:150px;text-align:center
}
button.donate{
    background:linear-gradient(135deg,#9c27b0,#7e57c2);
    color:#fff;border:none;padding:15px;
    border-radius:50px;width:100%;
    font-size:18px;cursor:pointer;margin-top:10px
}

/* ===== Dashboard ===== */
.dashboard{
    margin-top:80px;background:#fff;padding:30px;
    border-radius:25px;
    box-shadow:0 15px 40px rgba(126,87,194,.25)
}
.dashboard h2{text-align:center;color:#6a1b9a}
table{width:100%;border-collapse:collapse;margin-top:20px}
thead{background:#7e57c2;color:#fff}
th,td{padding:12px;text-align:center}
tbody tr:nth-child(even){background:#f3e5f5}
.badge{
    padding:5px 15px;border-radius:50px;font-size:13px
}
.badge-user{background:#d1c4e9}
.badge-guest{background:#ffe0b2;color:#e65100}

footer{text-align:center;margin:40px;color:#7b1fa2}
</style>
</head>

<body>
<div class="container">
    <div class="header">
        <button id="lang-switch">Switch to Arabic</button>
        <div class="logo">Ï€</div>
        <h1>Donate Way</h1>
        <p class="intro"></p>
        <div id="user"></div>
    </div>

    <div id="campaigns" class="campaigns"></div>

    <!-- Dashboard -->
    <div class="dashboard">
        <h2>Donations Dashboard</h2>
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Donor</th>
                    <th>Campaign</th>
                    <th>Amount</th>
                    <th>TXID</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody id="donations-table"></tbody>
        </table>
    </div>

    <footer>Donate Way Â© 2025</footer>
</div>

<script>
Pi.init({version:"2.0"});

let currentLang='en';
let currentUsername=null;
let selectedAmounts={};

const translations={
en:{
intro:"Donate with Pi Network to support charitable campaigns",
guest:"Donate as Guest",
hello:"Welcome, {name}",
donate:"Donate {amount} Pi",
campaigns:[
{title:"Food Aid",desc:"Help families with food",icon:"ðŸ²"},
{title:"Education",desc:"Support children education",icon:"ðŸ“š"},
{title:"Medical",desc:"Medical support for patients",icon:"ðŸ¥"},
{title:"Water",desc:"Clean water projects",icon:"ðŸ’§"}
]
},
ar:{
intro:"ØªØ¨Ø±Ø¹ Ø¨Ø¹Ù…Ù„Ø© Pi Ù„Ø¯Ø¹Ù… Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø®ÙŠØ±ÙŠØ©",
guest:"ØªØ¨Ø±Ø¹ ÙƒØ²Ø§Ø¦Ø±",
hello:"Ù…Ø±Ø­Ø¨Ø§Ù‹ {name}",
donate:"ØªØ¨Ø±Ø¹ {amount} Pi",
campaigns:[
{title:"Ù…Ø³Ø§Ø¹Ø¯Ø© ØºØ°Ø§Ø¦ÙŠØ©",desc:"ØªÙˆÙÙŠØ± Ø·Ø¹Ø§Ù… Ù„Ù„Ø£Ø³Ø±",icon:"ðŸ²"},
{title:"Ø§Ù„ØªØ¹Ù„ÙŠÙ…",desc:"Ø¯Ø¹Ù… ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø£Ø·ÙØ§Ù„",icon:"ðŸ“š"},
{title:"Ø§Ù„Ø¹Ù„Ø§Ø¬",desc:"Ù…Ø³Ø§Ø¹Ø¯Ø© Ø·Ø¨ÙŠØ©",icon:"ðŸ¥"},
{title:"Ø§Ù„Ù…ÙŠØ§Ù‡",desc:"Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…ÙŠØ§Ù‡ Ù†Ø¸ÙŠÙØ©",icon:"ðŸ’§"}
]
}
};

const intro=document.querySelector('.intro');
const userDiv=document.getElementById('user');
const campaignsDiv=document.getElementById('campaigns');
const tableBody=document.getElementById('donations-table');

function updateTexts(){
    const t=translations[currentLang];
    intro.textContent=t.intro;
    userDiv.textContent=currentUsername?
        t.hello.replace('{name}',currentUsername):
        t.guest;
}

function loadDonations(){
    const data=JSON.parse(localStorage.getItem('donations')||'[]');
    tableBody.innerHTML='';
    data.forEach((d,i)=>{
        tableBody.innerHTML+=`
        <tr>
            <td>${i+1}</td>
            <td><span class="badge ${d.donor==='Guest'?'badge-guest':'badge-user'}">${d.donor}</span></td>
            <td>${d.campaign}</td>
            <td>${d.amount}</td>
            <td>${d.txid}</td>
            <td>${d.date}</td>
        </tr>`;
    });
}

function saveDonation(d){
    const data=JSON.parse(localStorage.getItem('donations')||'[]');
    data.unshift({...d,date:new Date().toLocaleString()});
    localStorage.setItem('donations',JSON.stringify(data));
    loadDonations();
}

function renderCampaigns(){
    campaignsDiv.innerHTML='';
    translations[currentLang].campaigns.forEach((c,i)=>{
        const id='c'+i;
        selectedAmounts[id]=10;
        campaignsDiv.innerHTML+=`
        <div class="campaign-card" data-id="${id}">
            <div class="icon">${c.icon}</div>
            <h3>${c.title}</h3>
            <p>${c.desc}</p>
            <div>
                <button class="amount-btn selected" data-a="10">10</button>
                <button class="amount-btn" data-a="50">50</button>
                <button class="amount-btn" data-a="100">100</button>
            </div>
            <input class="custom-input" placeholder="Custom">
            <button class="donate">${translations[currentLang].donate.replace('{amount}',10)}</button>
        </div>`;
    });

    document.querySelectorAll('.campaign-card').forEach(card=>{
        const id=card.dataset.id;
        card.querySelectorAll('.amount-btn').forEach(btn=>{
            btn.onclick=()=>{
                card.querySelectorAll('.amount-btn').forEach(b=>b.classList.remove('selected'));
                btn.classList.add('selected');
                selectedAmounts[id]=btn.dataset.a;
                card.querySelector('.donate').textContent=
                translations[currentLang].donate.replace('{amount}',selectedAmounts[id]);
            }
        });

        card.querySelector('.donate').onclick=async()=>{
            const amount=selectedAmounts[id];
            const user=await Pi.authenticate(['payments','username']).catch(()=>({}));
            currentUsername=user.username||null;
            updateTexts();

            Pi.createPayment({
                amount,
                memo:"Donate Way",
            },{
                onReadyForServerCompletion:(pid,txid)=>{
                    saveDonation({
                        donor:currentUsername||'Guest',
                        campaign:translations[currentLang].campaigns[id[1]].title,
                        amount,txid
                    });
                    alert("Success "+txid);
                }
            });
        }
    });
}

document.getElementById('lang-switch').onclick=()=>{
    currentLang=currentLang==='en'?'ar':'en';
    document.documentElement.dir=currentLang==='ar'?'rtl':'ltr';
    updateTexts();renderCampaigns();
};

updateTexts();
renderCampaigns();
loadDonations();
</script>
</body>
</html>
